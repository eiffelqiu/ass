{"name":"Ass","tagline":"Apple Service Server was written with Ruby/Sinatra and Sequel(Sqlite3), it provides push notification with web admin interface","body":"ass\r\n=======\r\n####Apple Service Server was written with Ruby/Sinatra and Sequel(Sqlite3), it provides push notification with web admin interface ####\r\n\r\nFeature:\r\n=======\r\n\r\n1.  'ass' is a rubygem, simple to install.\r\n2.  only need to provide pem file.\r\n3.  no need to setup database(using sqlite3).\r\n4.  provide default config file(ass.yml) with default value.\r\n\r\nSqlite3 Installation\r\n=======\r\n\r\nCentOS/Redhat:\r\n\r\n    $ yum install sqlite3\r\n\r\nDebian/Ubuntu:\r\n\r\n    $ apt-get install sqlite3\r\n\r\nFreeBSD:\r\n\r\n    $ cd /usr/ports/databases/sqlite34\r\n    $ sudo make install clean\r\n\r\nMac:\r\n\r\n    $ brew install sqlite # Homebrew\r\n    $ port install sqlite # Macport\r\n\r\nInstallation\r\n\r\n* Method 1: with OS X builtin Ruby(AKA 'system ruby'), need to run with 'sudo', no extra step\r\n\r\n```bash\r\n$> sudo gem install ass\r\n```\r\n\r\n* Method 2: Install Ruby 1.9 (via RVM or natively) first, no need to run with 'sudo'\r\n\r\n```bash\r\n$> gem install rvm\r\n$> rvm install 1.9.3\r\n$> rvm use 1.9.3\r\n```\r\n\r\n* Install ass:\r\n\r\n```bash\r\n$> gem install ass\r\n```\r\n\t\r\nUsage\r\n=======\r\n\r\nunder the current directory, provide single pem file combined with certificate and key(name pattern: appid_mode.pem), HOWTO ([Check this link](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12))\r\n\r\nHow to make development pem file\r\n-------\r\n\r\ndev_cert.pem:\r\n\r\n\t$ openssl x509 -in aps_development.cer -inform der -out dev_cert.pem\r\n\r\ndev_key.pem:\r\n\r\n\t$ openssl pkcs12 -nocerts -in Certificates.p12 -out dev_key.pem\r\n\t$ Enter Import Password: \r\n\t$ MAC verified OK\r\n\t$ Enter PEM pass phrase: \r\n\t$ Verifying - Enter PEM pass phrase: \r\n\r\nDevelopment Pem:\r\n\r\n\tcat dev_cert.pem dev_key.pem > appid_development.pem\r\n\r\nHow to make produce production pem file\t\r\n-------\r\n\r\nprod_cert.pem:\r\n\r\n\t$ openssl x509 -in aps_production.cer -inform der -out prod_cert.pem\r\n\r\nprod_key.pem:\r\n\r\n\t$ openssl pkcs12 -nocerts -in Certificates.p12 -out prod_key.pem\r\n\t$ Enter Import Password: \r\n\t$ MAC verified OK\r\n\t$ Enter PEM pass phrase: \r\n\t$ Verifying - Enter PEM pass phrase: \r\n\r\nProduction Pem:\r\n\r\n\t$ cat prod_cert.pem prod_key.pem > appid_production.pem\t\r\n\r\nStart Ass server(default port is 4567)\r\n------- \r\n\t\r\n\t$ ass\r\n\r\n![ass usage](https://raw.github.com/eiffelqiu/ass/master/doc/capture1.png)\r\n![ass usage](https://raw.github.com/eiffelqiu/ass/master/doc/capture2.png)\r\n![ass usage](https://raw.github.com/eiffelqiu/ass/master/doc/capture3.png)\r\n![ass usage](https://raw.github.com/eiffelqiu/ass/master/doc/capture4.png)\r\nConfiguration (ass.yml)\r\n=======\r\n\r\nwhen you run 'ass' first time, it will generate 'ass.yml' config file under current directory. ([Check this link](https://raw.github.com/eiffelqiu/ass/master/ass.yml))\r\n\t\r\n\tport: 4567  ## ASS server port, default is sinatra's port number: 4567\r\n\tmode: development ## 'development' or 'production' mode, you should provide pem file ({appid}_{mode}.pem) accordingly(such as, app1_development.pem, app1_production.pem).\r\n\tcron: cron  ## cron job file name, ASS server will generate a demo 'cron' file for demostration only under current directory.\r\n\ttimer: 0\t# how often you run the cron job, unit: minute. when set with 0, means no cron job execute.\r\n\tuser: admin # admin username\r\n\tpass: pass\t# admin password\r\n\tapps:\r\n\t- app1 ## appid you want to supprt APNS, ASS Server can give push notification support for many iOS apps, just list the appid here.\r\n\r\n\r\nFAQ:\r\n=======\r\n\r\n1.  How to register notification? (Client Side)\r\n-------\r\n\r\nIn AppDelegate file, add methods below to register device token\r\n\r\n\t#pragma mark - push notification methods\r\n\r\n\t- (void)sendToken:(NSString *)token {\r\n\t    \r\n\t    NSString *tokenUrl = [NSString stringWithFormat:@\"http://serverIP:4567/v1/apps/app1/%@\", token];\r\n\t    NSLog(@\"tokenUrl: %@\", tokenUrl);\r\n\t    //prepare NSURL with newly created string\r\n\t    NSURL *url = [NSURL URLWithString:tokenUrl];\r\n\t    \r\n\t    //AsynchronousRequest to grab the data\r\n\t    NSURLRequest *request = [NSURLRequest requestWithURL:url];\r\n\t    NSOperationQueue *queue = [[NSOperationQueue alloc] init];\r\n\t    \r\n\t    [NSURLConnection sendAsynchronousRequest:request queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {\r\n\t        if ([data length] > 0 && error == nil) {\r\n\t            //            NSLog(@\"send data successfully\");\r\n\t        } else if ([data length] == 0 && error == nil) {\r\n\t            //            NSLog(@\"No data\");\r\n\t        } else if (error != nil && error.code == NSURLErrorTimedOut) { //used this NSURLErrorTimedOut from\r\n\t            //            NSLog(@\"Token Time out\");\r\n\t        } else if (error != nil) {\r\n\t            //            NSLog(@\"Error is: [%@]\", [error description]);\r\n\t        }\r\n\t    }];\r\n\t}\r\n\r\n\t- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken {\r\n\t    \r\n\t    if ([((AppDelegate *) [[UIApplication sharedApplication] delegate]) checkNetwork1]) {\r\n\t        NSString *tokenAsString = [[[deviceToken description]\r\n\t                                    stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@\"<>\"]]\r\n\t                                   stringByReplacingOccurrencesOfString:@\" \" withString:@\"\"];\r\n\t        NSLog(@\"My token is: [%@]\", tokenAsString);\r\n\t        [self sendToken:tokenAsString];\r\n\t    }\r\n\t    \r\n\t}\r\n\r\n\t- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error {\r\n\t    \r\n\t    NSLog(@\"Failed to get token, error: %@\", error);\r\n\t}\r\n\r\n\t- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo\r\n\t{\r\n\t    NSString *message = nil;\r\n\t    NSString *sound = nil;\r\n\t    NSString *extra = nil;\r\n\t    \r\n\t    id aps = [userInfo objectForKey:@\"aps\"];\r\n\t    extra = [userInfo objectForKey:@\"extra\"];\r\n\t    if ([aps isKindOfClass:[NSString class]]) {\r\n\t        message = aps;\r\n\t    } else if ([aps isKindOfClass:[NSDictionary class]]) {\r\n\t        message = [aps objectForKey:@\"alert\"];\r\n\t        sound = [aps objectForKey:@\"sound\"];\r\n\t        // badge\r\n\t    }\r\n\t    if (aps) {\r\n\t        DLog(@\"extra %@\",[NSString stringWithFormat:@\"sound %@ extra %@\", sound, extra ]);\r\n\t    }\r\n\t}\r\n\t\r\n2. How to send push notification? (Server Side)\r\n-------\r\n\r\nrun **curl** command to send push notification message on server' shell.\r\n\r\n\t$ curl http://localhost:4567/v1/apps/app1/push/{message}/{pid}\r\n\t\r\nNote:\r\n\r\nparam1 (message): push notification message you want to send, remember the message should be html escaped\r\n\r\nparam2 (pid ): unique string to mark the message, for example current timestamp or md5/sha1 digest\r\n\r\n3. How to send test push notification on web? \r\n-------\r\n\r\nopen your web browser and access http://localhost:4567/ (localhost should be changed to your server IP address accordingly), click \"admin\" on top navbar, you will see the Test Sending textbox on the top page, select your app , input your message and click 'send' button to send push notification.\r\n\r\n![ass usage](https://raw.github.com/eiffelqiu/ass/master/doc/capture5.png)\r\n\r\nContributing to ass\r\n=======\r\n \r\n* Check out the latest master to make sure the feature hasn't been implemented or the bug hasn't been fixed yet.\r\n* Check out the issue tracker to make sure someone already hasn't requested it and/or contributed it.\r\n* Fork the project.\r\n* Start a feature/bugfix branch.\r\n* Commit and push until you are happy with your contribution.\r\n* Make sure to add tests for it. This is important so I don't break it in a future version unintentionally.\r\n* Please try not to mess with the Rakefile, version, or history. If you want to have your own version, or is otherwise necessary, that is fine, but please isolate to its own commit so I can cherry-pick around it.\r\n\r\nCopyright\r\n=======\r\n\r\n#####Copyright (c) 2013 Eiffel Qiu. See LICENSE.txt for further details.#####\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}